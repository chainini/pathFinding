## 项目简介

这是一个Unity技术Demo项目，包含三个独立场景，分别展示不同的技术方向：
- **RTS/RPG双模式系统**：组件化架构与多模式控制
- **雨天涟漪特效**：Shader编程与CPU-GPU数据交互
- **Boids群体模拟**：经典群体行为算法实现

- 引擎：Unity（建议 2021+）
- 语言：C#（运行时）、HLSL（Shader）

---

## 场景介绍

### 场景1：RTS/RPG双模式系统（主要展示）

**核心特性：**
- **组件化单位架构**：`Unit` 容器聚合 `Health`、`Move`、`Attack`、`Animation`、`Navigation`、`StateMachine` 等组件，实现模块解耦
- **双模式控制**：
  - **RTS模式**：鼠标框选单位、右键地面移动、右键敌人攻击
  - **RPG模式**：第三人称角色控制、WASD移动、鼠标攻击
- **六边形阵型系统**：动态生成阵型槽位，距离最优分配算法，支持NavMesh投影验证
- **NavMesh + RVO导航**：路径规划 + 动态避障，支持多单位协同移动
- **战斗系统**：攻击状态机、扇形命中判定、受击反馈、攻击范围可视化

**技术亮点：**
- 可扩展的 `IFormationPlanner` 接口设计
- `GameModeManager` 统一管理模式切换
- `MaterialPropertyBlock` 实现单位独立的攻击范围特效
- `RPGInput` 输入抽象层，实现输入-逻辑-表现分离

**场景位置：** `Assets/Scenes/SampleScene.unity`

---

### 场景2：雨天涟漪特效

**核心特性：**
- **动态涟漪系统**：粒子碰撞触发，支持最多128个涟漪同时存在
- **GPU并行计算**：Shader中对每个像素计算多个涟漪的叠加效果
- **物理模拟**：
  - 时间衰减：涟漪随时间逐渐消失
  - 距离衰减：离中心越远越弱
  - 波形传播：正弦波扩散 + 振幅控制
- **水面效果**：
  - 水坑遮罩：噪声图定义积水区域
  - 流动扰动：双层噪声UV滚动模拟水流
  - 湿润反射：Fresnel效应实现环境反射

**技术亮点：**
- C# 数组传递到 Shader（`SetVectorArray` / `SetFloatArray`）
- `OnParticleCollision` 事件驱动涟漪生成
- 循环数组管理涟漪生命周期
- 多层效果叠加（涟漪 + 水坑 + 流动 + 反射）

**场景位置：** `Assets/Scenes/Rain.unity`

---

### 场景3：Boids群体模拟

**核心特性：**
- **三种行为力**：
  - **分离（Separation）**：避免单位重叠
  - **对齐（Alignment）**：保持群体方向一致
  - **聚合（Cohesion）**：向群体中心靠拢
- **边界约束**：距离中心越远推力越强，防止群体散开
- **双缓冲更新**：分离速度计算与位置更新，避免帧内数据依赖
- **参数可调**：感知半径、权重、最大速度等实时调节

**技术亮点：**
- 经典Boids算法的完整实现
- 邻居搜索优化（感知半径裁剪）
- 力的平衡与参数调优
- 支持100+单位实时模拟

**场景位置：** `Assets/Scenes/boids.unity`

---

## 运行方式

1. 使用 Unity 打开项目根目录
2. 在 `Assets/Scenes` 中打开对应场景
3. 点击 Play 运行：
   - **RTS/RPG场景**：
     - RTS模式：鼠标左键选择单位，右键移动/攻击
     - RPG模式：WASD移动，鼠标左键攻击
   - **雨天场景**：自动播放粒子效果，观察地面涟漪
   - **Boids场景**：观察100个方块的群体运动

---

## 代码结构

### RTS/RPG系统